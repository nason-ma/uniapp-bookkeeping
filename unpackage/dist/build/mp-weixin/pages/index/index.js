(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"0e07":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var n={uIcon:function(){return i.e("uview-ui/components/u-icon/u-icon").then(i.bind(null,"7a76"))},uActionSheet:function(){return i.e("uview-ui/components/u-action-sheet/u-action-sheet").then(i.bind(null,"5694"))},uCalendar:function(){return i.e("uview-ui/components/u-calendar/u-calendar").then(i.bind(null,"c38e"))}},a=function(){var t=this,e=t.$createElement,i=(t._self._c,Math.ceil(t.categories.length/(2*t.gridCol)));t._isMounted||(t.e0=function(e,i){var n=arguments[arguments.length-1].currentTarget.dataset,a=n.eventParams||n["event-params"];i=a.index2;return t.categoryChange(i)}),t.$mp.data=Object.assign({},{$root:{l0:i}})},o=[]},"11f8":function(t,e,i){"use strict";i.r(e);var n=i("0e07"),a=i("4ee0");for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("8d7a");var r,u=i("f0c5"),c=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,"d068282c",null,!1,n["a"],r);e["default"]=c.exports},"265d":function(t,e,i){"use strict";i.r(e);var n=i("7f01"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},"4a83":function(t,e,i){"use strict";var n=i("4f95"),a=i.n(n);a.a},"4ee0":function(t,e,i){"use strict";i.r(e);var n=i("a963"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},"4f95":function(t,e,i){},5594:function(t,e,i){"use strict";(function(t){i("27d5");n(i("66fd"));var e=n(i("866f"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},"7f01":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"bills",props:{bills:{type:Array,default:[]}},data:function(){return{modalName:null,listTouchStart:0,listTouchDirection:null}},methods:{ListTouchStart:function(t){this.listTouchStart=t.touches[0].pageX},ListTouchMove:function(t){this.listTouchDirection=t.touches[0].pageX-this.listTouchStart<-30?"left":"right"},ListTouchEnd:function(t){"left"==this.listTouchDirection?this.modalName=t.currentTarget.dataset.target:this.modalName=null,this.listTouchDirection=null},delBill:function(e){var i=this,n=e.currentTarget.dataset.index,a=e.currentTarget.dataset.index2,o=this.bills[n]["lists"][a].id;console.log(o),this.$u.api.Bill.destroy(o).then((function(e){i.$emit("reload"),t.showToast({title:"删除成功",duration:2e3})}))},goDetail:function(e){var i=e.currentTarget.dataset.id;t.navigateTo({url:"/pages/bill/detail?id="+i})}},mounted:function(){}};e.default=i}).call(this,i("543d")["default"])},"7f4a":function(t,e,i){},"866f":function(t,e,i){"use strict";i.r(e);var n=i("90f9"),a=i("c82b");for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("d565");var r,u=i("f0c5"),c=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,"2d3a77d4",null,!1,n["a"],r);e["default"]=c.exports},"8d7a":function(t,e,i){"use strict";var n=i("d9fc"),a=i.n(n);a.a},"90f9":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var n={uIcon:function(){return i.e("uview-ui/components/u-icon/u-icon").then(i.bind(null,"7a76"))},uBackTop:function(){return i.e("uview-ui/components/u-back-top/u-back-top").then(i.bind(null,"44ed"))},uPicker:function(){return Promise.all([i.e("common/vendor"),i.e("uview-ui/components/u-picker/u-picker")]).then(i.bind(null,"0695"))}},a=function(){var t=this,e=t.$createElement;t._self._c},o=[]},"9cbf":function(t,e,i){"use strict";i.r(e);var n=i("c10a"),a=i("265d");for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("4a83");var r,u=i("f0c5"),c=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,"ec3bf374",null,!1,n["a"],r);e["default"]=c.exports},a963:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"billform",props:{billInfo:{type:Object,default:null}},watch:{billInfo:function(t,e){this.billInfo=t,this.billInfo2BillData()}},data:function(){return{BillFormShow:!1,billData:{id:0,ledger_id:0,date:"",type:0,account_id:0,amount:"",category_id:0,note:"",images:[]},chooseImages:[],accountsShow:!1,accountName:"",accounts:[],categoryColorClass:"text-orange",categories:[],decCategories:[],inCategories:[],gridCol:5,gridBorder:!1,categorySwiperCurrent:0,old:{categorySwiperCurrent:0},pickerDateShow:!1}},methods:{swiperScroll:function(t){this.old.categorySwiperCurrent=t.detail.current},showPickerDate:function(){this.pickerDateShow=!0},pickerDateConfirm:function(t){this.billData.date=t.result},billType:function(t){this.billData.type=parseInt(t.currentTarget.dataset.type),this.typeChange(),this.billData.category_id=this.categories[0].id},typeChange:function(){this.categoryColorClass=0==this.billData.type?"text-orange":"text-blue",this.categories=0==this.billData.type?this.decCategories:this.inCategories,this.categorySwiperCurrent=this.old.categorySwiperCurrent,this.$nextTick((function(){this.categorySwiperCurrent=0}))},categoryChange:function(t){this.billData.category_id=this.categories[t].id},ChooseImage:function(){var e=this;t.chooseImage({count:4,sizeType:["original","compressed"],success:function(i){0!=e.chooseImages.length?e.chooseImages=e.chooseImages.concat(i.tempFilePaths):e.chooseImages=i.tempFilePaths,e.$u.api.Common.uploadImage(i.tempFilePaths[0],"bill").then((function(i){var n=i[1];if(200==n.statusCode){var a=JSON.parse(n.data);e.billData.images=e.billData.images.concat(a.path)}else t.showToast({title:"图片上传失败",icon:error,duration:2e3})}))}})},ViewImage:function(e){t.previewImage({urls:this.chooseImages,current:e.currentTarget.dataset.url})},DelImg:function(e){var i=this;t.showModal({title:"提示",content:"确定删除？",cancelText:"取消",confirmText:"确定",success:function(t){t.confirm&&(i.chooseImages.splice(e.currentTarget.dataset.index,1),i.billData.images.splice(e.currentTarget.dataset.index,1))}})},accountCallback:function(e){t.hideKeyboard(),this.billData.account_id=this.accounts[e].id,this.accountName=this.accounts[e].text},accountChange:function(t){this.accountsShow=!0},getCategories:function(t){var e=this;this.$u.api.Category.categories(t).then((function(i){0===t?(e.decCategories=i.data,e.categories=i.data,e.billData.category_id=i.data[0].id):e.inCategories=i.data}))},getAccounts:function(){var t=this;this.$u.api.Common.accounts().then((function(e){t.accounts=e.data,t.accountName=e.data[0].text}))},init:function(){this.getCategories(0),this.getCategories(1),this.getAccounts()},initBillData:function(){this.categories=this.decCategories,this.billData.id=0,this.billData.ledger_id=0,this.billData.type=0,this.billData.account_id=0,this.billData.amount="",this.billData.category_id=this.categories[0].id,this.billData.note="",this.billData.images=[],this.chooseImages=[],this.initDate()},billInfo2BillData:function(){this.billData.id=this.billInfo.id,this.billData.ledger_id=this.billInfo.ledger_id,this.billData.date=this.billInfo.date_text,this.billData.type=this.billInfo.type,this.billData.account_id=this.billInfo.account_id,this.billData.amount=Math.abs(this.billInfo.amount),this.billData.category_id=this.billInfo.category_id,this.billData.note=this.billInfo.note,this.billData.images=this.billInfo.images,this.chooseImages=this.billInfo.images,this.accountName=this.billInfo.account.text,1==this.billInfo.type?this.categories=this.decCategories:this.categories=this.inCategories,this.typeChange()},initDate:function(){var t=(new Date).getFullYear(),e=(new Date).getMonth()+1,i=(new Date).getDate();e=e<10?"0"+e:e,this.billData.date=t+"-"+e+"-"+i},save:function(){var e=this,i=this.billData.id>0?"更新":"创建";if(""==this.billData.amount||this.billData.amount<=0)return t.showToast({title:"金额填写有误",icon:"error",duration:2e3}),!1;this.$u.api.Bill.save(this.billData).then((function(n){!1!==n?(e.hideBillForm(),e.$emit("reload"),t.showToast({title:i+"成功",duration:2e3}),0===e.billData.id&&e.initBillData()):t.showToast({title:i+"失败",icon:"error",duration:2e3})})).catch((function(t){console.log(t)}))},showBillForm:function(){this.BillFormShow=!0},hideBillForm:function(){this.BillFormShow=!1,this.billData.id>0?this.billInfo2BillData():this.initBillData()}},mounted:function(){this.$store.state.vuex_scopeUserInfo||t.redirectTo({url:"/pages/auth/auth"}),this.initDate(),this.init()}};e.default=i}).call(this,i("543d")["default"])},c10a:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var n={uEmpty:function(){return i.e("uview-ui/components/u-empty/u-empty").then(i.bind(null,"faa8"))}},a=function(){var t=this,e=t.$createElement;t._self._c},o=[]},c82b:function(t,e,i){"use strict";i.r(e);var n=i("ec11"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},d565:function(t,e,i){"use strict";var n=i("7f4a"),a=i.n(n);a.a},d9fc:function(t,e,i){},ec11:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(i("a34a")),a=r(i("9cbf")),o=r(i("11f8"));function r(t){return t&&t.__esModule?t:{default:t}}function u(t,e,i,n,a,o,r){try{var u=t[o](r),c=u.value}catch(error){return void i(error)}u.done?e(c):Promise.resolve(c).then(n,a)}function c(t){return function(){var e=this,i=arguments;return new Promise((function(n,a){var o=t.apply(e,i);function r(t){u(o,n,a,r,c,"next",t)}function c(t){u(o,n,a,r,c,"throw",t)}r(void 0)}))}}var s={components:{bills:a.default,billform:o.default},data:function(){return{headerHeight:0,CustomBar:this.CustomBar,inAmount:"0.00",decAmount:"0.00",quotation:"授权登录，开启记账之旅~",filterParams:{year:"",month:""},pickerMonthParams:{year:!0,month:!0,day:!1},pickerMonthShow:!1,billList:[],scrollTop:0}},onLoad:function(){var t=c(n.default.mark((function t(e){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),onShow:function(){""!=this.filterParams.year&&""!=this.filterParams.month||(this.filterParams.year=(new Date).getFullYear(),this.filterParams.month=(new Date).getMonth()+1),this.init()},onPageScroll:function(t){this.scrollTop=t.scrollTop},onPullDownRefresh:function(){this.init(),setTimeout((function(){t.stopPullDownRefresh()}),1e3)},methods:{showPickerMonth:function(){this.pickerMonthShow=!0},pickerMonthConfirm:function(t){this.filterParams.year=t.year,this.filterParams.month=parseInt(t.month),this.init()},randomQuotation:function(){var t=this;this.$u.api.Share.randomQuotation().then((function(e){t.quotation=e.title}))},getIndex:function(){var t=this;this.$u.api.Bill.index(this.filterParams).then((function(e){t.inAmount=e.inAmount,t.decAmount=e.decAmount,t.billList=e.bills}))},init:function(){this.randomQuotation(),this.getIndex()}},mounted:function(){var e=this;this.$store.state.vuex_scopeUserInfo||t.redirectTo({url:"/pages/auth/auth"});var i=t.createSelectorQuery().in(this);i.select("#header").boundingClientRect((function(t){e.headerHeight=t.height})).exec()}};e.default=s}).call(this,i("543d")["default"])}},[["5594","common/runtime","common/vendor"]]]);